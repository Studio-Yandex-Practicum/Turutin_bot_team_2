## Проект Turutin_bot
Это чат-бот, который проводит воодную часть опроса клиентов, форминует заявки и ведёт журнал заявок.
Это административный `web` интерфейс, где операторы и администраторы могут работать с заявками клентов.

Проект включает основную папку с кодом `/src`
 - `admin_app/`
 - `bot_app/`

### admin_app/

описание админки

### bot_app/

описание бота

### infra/
Здесь находится файл для запуска сети через CI/CD:
`docker-compose.production.yml`
Файл локального запуска:
`docker-compose.yml`
Пример переменных окружения:
`.env.example`

## Запуск проекта с помощью CI/CD
### описание

...

## Локальный запуск проекта с помощью Docker compose
### Администрирование: 127.0.0.1:8000

В директории `infra/` находится файл `.env.example`, пример для создания
файла .env, который хранит переменные окружения проекта.
Для работы бота, необходимо указать токен в BOT_TOKEN для запуска вашего бота с исходным кодом проекта. Боту не требуются внешние подключения или иные настройки.

Если вы используете Windiws, необходимо поставить файлы
`infra/docker-compose.yml`, `src/admin_app/Dockerfile`, `src/admin_app/start.sh`
в режим LF (Линкус совместимость).

Находясь в директории `infra/` можно выполнить следующие команды:
Запуск в терминале с логами (для отладки)
```shell
docker compose up
```
Фоновый запуск
```shell
docker compose up -d
```
Обновить и поднять сеть после ваших локальных изменений в коде:
```shell
docker compose up --build
```
Создание суперпользователя с именем `user` и паролем `password`
в рабочей сети контейнеров (пример):
```shell
docker exec -it infra-admin-1 flask create_superuser user password
```
Если у вас на локальной машине есть другие компоненты `Docker` эта команда
НЕ РЕКОМЕНДУЕТСЯ
Команда для удаления ВСЕХ неиспользуемых компонентов Docker:
 - при запущенной локальной сети - удалит все неиспользуемые компоненты Docker
 - при запуске без рабочего процесса - удаляет все компоненты Docker
```shell
docker system prune -a
```

### Для выполенения следующих команд использовать среду выполнения Linux - WSL 
1) Обновить список доступных пакетов из репозиториев, чтобы получить последние версии пакетов
```
sudo apt-get update
```
2) Обновить все установленные пакеты до их последних версий
```
sudo apt-get upgrade
```
3) Установить виртуальное окружение Python, которое помогает изолировать пакеты для проекта
```
sudo apt install python3-venv
```
4) Создать новое виртуальное окружение Python с именем 'venv'
```
python3 -m venv venv
```
5) Активировать виртуальное окружение Python, чтобы все установленные пакеты были доступны только в данном окружении
```
source venv/bin/activate
```
6) Перейти в директорию с файлом docker-compose.yml
```
cd/infra
```
7) Запустить все сервисы, указанные в docker-compose.yml с обновленными образами
```
docker compose up --build
```
8) Запустить интерактивную оболочку bash внутри контейнера с именем 'infra-admin-1' и создать суперпользователя с именем 'user' и паролем 'password'
```
docker exec -it infra-admin-1 flask create_superuser user password
```
9) Открыть админку по ссылке http://127.0.0.1:8000
10) Открыть бота в тг и запустить его командой "/start"


## Стилистика

Для стилизации кода используется пакеты `Ruff` и `Pre-commit`

Проверка стилистики кода осуществляется командой
```shell
ruff check
```

Если одновременно надо пофиксить то, что можно поиксить автоматически, то добавляем параметр `--fix`
```shell
ruff check --fix
```

Что бы стилистика автоматически проверялась и поправлялась при комитах надо добавить hook pre-commit к git

```shell
pre-commit install
```
# Шаблон для проектов со стилизатором Ruff

## Основное

1. Базовая версия Python - 3.11.
2. В файле `requirements_style.txt` находятся зависимости для стилистики.
3. В каталоге `src` находится базовая структура проекта
4. В файле `srd/requirements.txt` прописываются базовые зависимости.
5. В каталоге `infra` находятся настроечные файлы проекта. Здесь же размещать файлы для docker compose.
